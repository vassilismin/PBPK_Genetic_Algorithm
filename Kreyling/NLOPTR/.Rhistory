y = ifelse(excreta,"TiO2 (mg)","TiO2 (mg/g tissue)" ),
x = "Time (hours)")+
theme(plot.title = element_text(hjust = 0.5))+
{if(compartment %in% c("Blood", "Kidneys", "Heart", "Bone", "Lungs" ))scale_y_continuous(trans='log10')}+
scale_color_manual("", values=cls)+
scale_linetype_manual("Metrics", values=ltp) +
theme(  legend.position = "top",
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
axis.text = element_text(size = 14))
}
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
ggsave("metric_selection.tiff",plot=ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")
,device='tiff', dpi=320,scale = 1,
width = 15,
height = 12,
units = "in")
dev.off()
create.plots <- function(compartment){
excreta <- compartment %in% c("Feces", "Urine")
ggplot(data = solution_r)+
geom_line( aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"R-squared"',linetype = '"R-squared"'),  size=1.5,alpha = 0.7) +
geom_line(data=solution_pbpk, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"PBPK index"',linetype ='"PBPK index"'), size=1.5,alpha = 0.9) +
geom_line(data=solution_new, aes_string(x= "Time", y= rlang::expr(!!compartment),
color =  '"SODI"',linetype =  '"SODI"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_aafe, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"AAFE"',linetype ='"AAFE"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_rmsd, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"RMSD"',linetype = '"RMSD"'), size=1.5,alpha = 0.7) +
geom_point(data=observations, aes_string(x="Time", y= rlang::expr(!!compartment),
color='"Observations"'), size=4)+
labs(title = rlang::expr(!!compartment),
y = ifelse(excreta,"TiO2 (mg)","TiO2 (mg/g tissue)" ),
x = "Time (hours)")+
theme(plot.title = element_text(hjust = 0.5))+
{if(compartment %in% c("Blood", "Kidneys", "Heart", "Bone", "Lungs" ))scale_y_continuous(trans='log10')}+
scale_color_manual("", values=cls)+
scale_linetype_manual("Metrics", values=ltp) +
theme(  legend.justification = "top" ,
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
axis.text = element_text(size = 14))
}
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
ggsave("metric_selection.tiff",plot=ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")
,device='tiff', dpi=320,scale = 1,
width = 15,
height = 12,
units = "in")
dev.off()
create.plots <- function(compartment){
excreta <- compartment %in% c("Feces", "Urine")
ggplot(data = solution_r)+
geom_line( aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"R-squared"',linetype = '"R-squared"'),  size=1.5,alpha = 0.7) +
geom_line(data=solution_pbpk, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"PBPK index"',linetype ='"PBPK index"'), size=1.5,alpha = 0.9) +
geom_line(data=solution_new, aes_string(x= "Time", y= rlang::expr(!!compartment),
color =  '"SODI"',linetype =  '"SODI"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_aafe, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"AAFE"',linetype ='"AAFE"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_rmsd, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"RMSD"',linetype = '"RMSD"'), size=1.5,alpha = 0.7) +
geom_point(data=observations, aes_string(x="Time", y= rlang::expr(!!compartment),
color='"Observations"'), size=4)+
labs(title = rlang::expr(!!compartment),
y = ifelse(excreta,"TiO2 (mg)","TiO2 (mg/g tissue)" ),
x = "Time (hours)")+
theme(plot.title = element_text(hjust = 0.5))+
{if(compartment %in% c("Blood", "Kidneys", "Heart", "Bone", "Lungs" ))scale_y_continuous(trans='log10')}+
scale_color_manual("", values=cls)+
scale_linetype_manual("Metrics", values=ltp) +
theme(  legend.justification = "top" ,
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
axis.text = element_text(size = 14))+
theme(plot.margin = unit(c(0.25,0.25,0.25,0.25), "in"))
}
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
ggsave("metric_selection.tiff",plot=ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")
,device='tiff', dpi=320,scale = 1,
width = 15,
height = 12,
units = "in")
dev.off()
warnings()
create.plots <- function(compartment){
excreta <- compartment %in% c("Feces", "Urine")
ggplot(data = solution_r)+
geom_line( aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"R-squared"',linetype = '"R-squared"'),  size=1.5,alpha = 0.7) +
geom_line(data=solution_pbpk, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"PBPK index"',linetype ='"PBPK index"'), size=1.5,alpha = 0.9) +
geom_line(data=solution_new, aes_string(x= "Time", y= rlang::expr(!!compartment),
color =  '"SODI"',linetype =  '"SODI"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_aafe, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"AAFE"',linetype ='"AAFE"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_rmsd, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"RMSD"',linetype = '"RMSD"'), size=1.5,alpha = 0.7) +
geom_point(data=observations, aes_string(x="Time", y= rlang::expr(!!compartment),
color='"Observations"'), size=4)+
labs(title = rlang::expr(!!compartment),
y = ifelse(excreta,"TiO2 (mg)","TiO2 (mg/g tissue)" ),
x = "Time (hours)")+
theme(plot.title = element_text(hjust = 0.5))+
{if(compartment %in% c("Blood", "Kidneys", "Heart", "Bone", "Lungs" ))scale_y_continuous(trans='log10')}+
scale_color_manual("", values=cls)+
scale_linetype_manual("Metrics", values=ltp) +
theme(  legend.justification = "top" ,
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
axis.text = element_text(size = 14))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"))
}
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
ggsave("metric_selection.tiff",plot=ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")
,device='tiff', dpi=320,scale = 1,
width = 15,
height = 12,
units = "in")
dev.off()
create.plots <- function(compartment){
excreta <- compartment %in% c("Feces", "Urine")
ggplot(data = solution_r)+
geom_line( aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"R-squared"',linetype = '"R-squared"'),  size=1.5,alpha = 0.7) +
geom_line(data=solution_pbpk, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"PBPK index"',linetype ='"PBPK index"'), size=1.5,alpha = 0.9) +
geom_line(data=solution_new, aes_string(x= "Time", y= rlang::expr(!!compartment),
color =  '"SODI"',linetype =  '"SODI"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_aafe, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"AAFE"',linetype ='"AAFE"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_rmsd, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"RMSD"',linetype = '"RMSD"'), size=1.5,alpha = 0.7) +
geom_point(data=observations, aes_string(x="Time", y= rlang::expr(!!compartment),
color='"Observations"'), size=4)+
labs(title = rlang::expr(!!compartment),
y = ifelse(excreta,"TiO2 (mg)","TiO2 (mg/g tissue)" ),
x = "Time (hours)")+
theme(plot.title = element_text(hjust = 0.5))+
{if(compartment %in% c("Blood", "Kidneys", "Heart", "Bone", "Lungs" ))scale_y_continuous(trans='log10')}+
scale_color_manual("", values=cls)+
scale_linetype_manual("Metrics", values=ltp) +
theme(  legend.justification = "top" ,
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
axis.text = element_text(size = 14))+
theme(plot.margin = unit(c(10,10,10,10), "cm"))
}
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
ggsave("metric_selection.tiff",plot=ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")
,device='tiff', dpi=320,scale = 1,
width = 15,
height = 12,
units = "in")
dev.off()
create.plots <- function(compartment){
excreta <- compartment %in% c("Feces", "Urine")
ggplot(data = solution_r)+
geom_line( aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"R-squared"',linetype = '"R-squared"'),  size=1.5,alpha = 0.7) +
geom_line(data=solution_pbpk, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"PBPK index"',linetype ='"PBPK index"'), size=1.5,alpha = 0.9) +
geom_line(data=solution_new, aes_string(x= "Time", y= rlang::expr(!!compartment),
color =  '"SODI"',linetype =  '"SODI"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_aafe, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"AAFE"',linetype ='"AAFE"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_rmsd, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"RMSD"',linetype = '"RMSD"'), size=1.5,alpha = 0.7) +
geom_point(data=observations, aes_string(x="Time", y= rlang::expr(!!compartment),
color='"Observations"'), size=4)+
labs(title = rlang::expr(!!compartment),
y = ifelse(excreta,"TiO2 (mg)","TiO2 (mg/g tissue)" ),
x = "Time (hours)")+
theme(plot.title = element_text(hjust = 0.5))+
{if(compartment %in% c("Blood", "Kidneys", "Heart", "Bone", "Lungs" ))scale_y_continuous(trans='log10')}+
scale_color_manual("", values=cls)+
scale_linetype_manual("Metrics", values=ltp) +
theme(  legend.justification = "top" ,
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
axis.text = element_text(size = 14))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"))
}
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
ggsave("metric_selection.tiff",plot=ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")
,device='tiff', dpi=320,
width = 15,
height = 12,
units = "in")
dev.off()
create.plots <- function(compartment){
excreta <- compartment %in% c("Feces", "Urine")
ggplot(data = solution_r)+
geom_line( aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"R-squared"',linetype = '"R-squared"'),  size=1.5,alpha = 0.7) +
geom_line(data=solution_pbpk, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"PBPK index"',linetype ='"PBPK index"'), size=1.5,alpha = 0.9) +
geom_line(data=solution_new, aes_string(x= "Time", y= rlang::expr(!!compartment),
color =  '"SODI"',linetype =  '"SODI"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_aafe, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"AAFE"',linetype ='"AAFE"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_rmsd, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"RMSD"',linetype = '"RMSD"'), size=1.5,alpha = 0.7) +
geom_point(data=observations, aes_string(x="Time", y= rlang::expr(!!compartment),
color='"Observations"'), size=4)+
labs(title = rlang::expr(!!compartment),
y = ifelse(excreta,"TiO2 (mg)","TiO2 (mg/g tissue)" ),
x = "Time (hours)")+
theme(plot.title = element_text(hjust = 0.5))+
{if(compartment %in% c("Blood", "Kidneys", "Heart", "Bone", "Lungs" ))scale_y_continuous(trans='log10')}+
scale_color_manual("", values=cls)+
scale_linetype_manual("Metrics", values=ltp) +
theme(  legend.justification = "top" ,
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
axis.text = element_text(size = 14))+
theme(plot.margin=grid::unit(c(0,0,0,0), "mm"))
}
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
ggsave("metric_selection.tiff",plot=ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")
,device='tiff', dpi=320,
width = 15,
height = 12,
units = "in")
dev.off()
ggsave("metric_selection.tiff",plot=(ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm")))
,device='tiff', dpi=320,
width = 15,
height = 12,
units = "in")
dev.off()
final_plot=(ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm"))
final_plot<- ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm"))
final_plot
final_plot<- ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm"))
ggsave("metric_selection.tiff",plot = final_plot,
device='tiff', dpi=320,
width = 15,
height = 12,
units = "in")
dev.off()
ggsave("metric_selection.tiff",plot = final_plot,
device='tiff', dpi=300,
width = 15,
height = 12,
units = "in")
dev.off()
dev.off()
final_plot<- ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm"))
ggsave("metric_selection.tiff",plot = final_plot,
device='tiff', dpi=300,
width = 15,
height = 12,
units = "in")
create.plots <- function(compartment){
excreta <- compartment %in% c("Feces", "Urine")
ggplot(data = solution_r)+
geom_line( aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"R-squared"',linetype = '"R-squared"'),  size=1.5,alpha = 0.7) +
geom_line(data=solution_pbpk, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"PBPK index"',linetype ='"PBPK index"'), size=1.5,alpha = 0.9) +
geom_line(data=solution_new, aes_string(x= "Time", y= rlang::expr(!!compartment),
color =  '"SODI"',linetype =  '"SODI"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_aafe, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"AAFE"',linetype ='"AAFE"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_rmsd, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"RMSD"',linetype = '"RMSD"'), size=1.5,alpha = 0.7) +
geom_point(data=observations, aes_string(x="Time", y= rlang::expr(!!compartment),
color='"Observations"'), size=4)+
labs(title = rlang::expr(!!compartment),
y = ifelse(excreta,"TiO2 (mg)","TiO2 (mg/g tissue)" ),
x = "Time (hours)")+
theme(plot.title = element_text(hjust = 0.5))+
{if(compartment %in% c("Blood", "Kidneys", "Heart", "Bone", "Lungs" ))scale_y_continuous(trans='log10')}+
scale_color_manual("", values=cls)+
scale_linetype_manual("Metrics", values=ltp) +
theme(  legend.justification = "top" ,
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=10),
legend.text = element_text(size=10),
axis.text = element_text(size = 14))+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm"))
}
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
final_plot<- ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm"))
ggsave("metric_selection.tiff",plot = final_plot,
device='tiff', dpi=300,
width = 15,
height = 12,
units = "in")
dev.off()
library(ggplot2)
# Defining the linetype and colour of each curve
ltp <- c("R-squared" = "twodash","RMSD" ="dotted", "SODI" = "solid", "AAFE" = "longdash","PBPK index" = "dashed")
cls <-  c("R-squared" = "#56B4E9", "RMSD" = "#E69F00", "SODI" ="#000000", "AAFE" = "#009E73", "PBPK index" ="#CC79A7",
"Observations" = "#D55E00")
create.plots <- function(compartment){
excreta <- compartment %in% c("Feces", "Urine")
ggplot(data = solution_r)+
geom_line( aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"R-squared"',linetype = '"R-squared"'),  size=1.5,alpha = 0.7) +
geom_line(data=solution_pbpk, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"PBPK index"',linetype ='"PBPK index"'), size=1.5,alpha = 0.9) +
geom_line(data=solution_new, aes_string(x= "Time", y= rlang::expr(!!compartment),
color =  '"SODI"',linetype =  '"SODI"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_aafe, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"AAFE"',linetype ='"AAFE"'), size=1.5,alpha = 0.7) +
geom_line(data=solution_rmsd, aes_string(x= "Time", y= rlang::expr(!!compartment),
color = '"RMSD"',linetype = '"RMSD"'), size=1.5,alpha = 0.7) +
geom_point(data=observations, aes_string(x="Time", y= rlang::expr(!!compartment),
color='"Observations"'), size=4)+
labs(title = rlang::expr(!!compartment),
y = ifelse(excreta,"TiO2 (mg)","TiO2 (mg/g tissue)" ),
x = "Time (hours)")+
theme(plot.title = element_text(hjust = 0.5))+
{if(compartment %in% c("Blood", "Kidneys", "Heart", "Bone", "Lungs" ))scale_y_continuous(trans='log10')}+
scale_color_manual("", values=cls)+
scale_linetype_manual("Metrics", values=ltp) +
theme(  legend.justification = "top" ,
legend.key.size = unit(1.5, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
axis.text = element_text(size = 14))+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm"))
}
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
final_plot<- ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm"))
ggsave("metric_selection.tiff",plot = final_plot,
device='tiff', dpi=300,
width = 15,
height = 12,
units = "in")
dev.off()
plots <- lapply(names(observations)[2:length(observations)],create.plots)
p1 <-  plots[[1]]
p2 <-  plots[[2]]
p3 <-  plots[[3]]
p4 <-  plots[[4]]
p5 <-  plots[[5]]
p6 <-  plots[[6]]
p7 <-  plots[[7]]
p8 <-  plots[[8]]
p9 <-  plots[[9]]
#gridExtra::grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8, p9,p10, nrow = 4)
#gridExtra::grid.arrange(p5,p6,p7,p8,nrow = 2)
#gridExtra::grid.arrange(p9,p10,nrow = 2)
final_plot<- ggpubr::ggarrange(p1, p2, p3, p4,p5,p6,p7,p8, p9, ncol=3, nrow=4,
common.legend = TRUE, legend="right")+
theme(plot.margin=grid::unit(c(0.25,0.25,0.25,0.25), "cm"))
ggsave("metric_selection.tiff",plot = final_plot,
device='tiff', dpi=300,
width = 15,
height = 12,
units = "in")
dev.off()
ggsave("metric_selection.png",plot = final_plot,
device='tiff', dpi=300,
width = 15,
height = 12,
units = "in")
dev.off()
ggsave("metric_selection_low.tiff",plot = final_plot,
device='tiff', dpi=50,
width = 15,
height = 12,
units = "in")
dev.off()
ggsave("metric_selection_low.tiff",plot = final_plot,
device='tiff', dpi=100,
width = 15,
height = 12,
units = "in")
dev.off()
